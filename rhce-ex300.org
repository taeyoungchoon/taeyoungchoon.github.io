* TODO REBOOT : server then client and sure about any

- iscsi, samba, nfs
- systemctl enable samba
- config well
- fstab with _netdev
- firewalld

* DONE tiling 2:1
  CLOSED: [2018-04-04 Wed 15:42]

- [ ] about firefox
- save file fail on hypervisor, ssh key file
  
* DONE /etc/hosts
  CLOSED: [2018-03-08 Thu 13:46]

- 172.28.128.100 server12.f.com server12
- 172.28.128.200 desktop12.f.com desktop12

* DONE mandb
  CLOSED: [2018-03-07 Wed 15:43]

- mandb
- man -k firewall

* DONE change root passwd
  CLOSED: [2018-03-07 Wed 15:21]

rd.break
mount -o remount,rw /sysroot
chroot /sysroot
passwd root
touch /.autorelabel
exit
exit

* DONE mask
  CLOSED: [2018-03-07 Wed 15:21]

- systemctl mask iptables ip6tables ebtables
- systemctl status iptables ip6tables ebtables

* DONE enable selinux
  CLOSED: [2018-03-07 Wed 15:22]

- getenforce
- /etc/selinux/config
- SELINUX=enforcing

* DONE gather dns using nslookup or using /etc/resolv.conf
  CLOSED: [2018-03-07 Wed 15:22]

- nslookkup
- cat /etc/resolv.conf

* DONE ipv4
  CLOSED: [2018-03-07 Wed 15:30]

- ip addr
- ifconfig
- ip route
- route -n
- nmcli con add con-name mynet type ethernet ifname eth0
- nmcli con mod mynet
  ipv4.method manual
  ipv4.addresses "192.168.33.100/24 192.168.33.1"
  ipv4.dns 8.8.8.8
  connection.autoconnect yes
- nmcil up mynet
- nmcli con delete "System eth0"
- nmcli con 

* DONE ipv6, need a sample ipv6 address
  CLOSED: [2018-04-04 Wed 15:26]

** server

- nmcli con mod mynet
  ipv6.method manual
  ipv6.addresses "2001:db8:1::1/64"

** client

- nmcli con mod mynet
  ipv6.method manual
  ipv6.addresses "2001:db8:1::2/64"
- ping6 -I eth1 2001:db8:1::1

* DONE teaming
  CLOSED: [2018-03-07 Wed 15:30]

- https://www.rootusers.com/how-to-configure-network-teaming-in-linux/
- man nmcli-examples

- nmcli con mod "System eth1" connection.autoconnect no
- nmcli con mod "System eth2" connection.autoconnect no
- nmcli con down "System eth1"
- nmcli con down "System eth2"

- nmcli con add con-name team0 type team ifname team0
- nmcli con mod team0
  ipv4.method manual
  ipv4.addresses "192.168.33.101/24"
  connection.autoconnect yes
  config '{"runner" : {"name" : "activebackup" }}'
- nmcli con add con-name team0-port0 type team-slave ifname eth1 master team0
- nmcli con add con-name team0-port1 type team-slave ifname eth2 master team0
- nmcli con up team0-port0
- nmcli con up team0-port1
- nmcli con up team0
- teamdctl team0 state

* DONE firewalld about zone
  CLOSED: [2018-04-04 Wed 17:12]

- systemctl status firewalld
- systemctl enable firewalld
- systemctl start firewalld
- systemctl status firewalld
- firewall-cmd --list-all

- firewall-cmd --get-zones
- firewall-cmd --get-default-zone
- firewall-cmd --get-active-zones

- firewall-cmd --set-default-zone=dmz
- firewall-cmd --list-all

- [ ] dmz then more

* DONE firewalld about forward
  CLOSED: [2018-04-04 Wed 17:12]

- yum reinstall firewalld
- man firewalld.richlanguage | grep to-port
- firewall-cmd --permanent --add-rich-rule="rule family=ipv4
  source address=192.168.33.0/24
  forward-port port=2222
  protocol=tcp
  to-port=22"
- firewall-cmd --reload
- firewall-cmd --list-all

* DONE authconfig-gtk for kerberos and more
  CLOSED: [2018-04-04 Wed 17:12]
* DONE krb5-workstation and more for nfs-secure-server, nil from c7.0
  CLOSED: [2018-03-08 Thu 22:41]
* DONE yum repository
  CLOSED: [2018-03-08 Thu 11:27]

- yum-config-manager --add-repo=http://ftp.daumkakao.com/centos/7/os/x86_64
- /etc/yum.repo.d
- gpgcheck=0
- yum repolist
- yum install lynx
- yum reinstall firewalld

* DONE yum and rpm basic
  CLOSED: [2018-03-08 Thu 11:27]

- rpm -qa | grep samba
- rpm -ql lvm2
- rpm -qf /sbin/lvs
- yum whatprovides ifconfig
- yum search mariadb
- yum install mariadb
- yum reinstall lvm2
- yum repolist

* DONE systemd and journalctl
  CLOSED: [2018-03-08 Thu 14:48]

- journalctl -f
- journalctl -u httpd

* DONE ip addr and more
  CLOSED: [2018-03-08 Thu 14:48]

- ip addr
- ip route
- ip neigh

* DONE selinux one
  CLOSED: [2018-03-08 Thu 14:48]

- semanage fcontext -l | grep httpd_sys_content_t
- semanage port -l | grep ssh
- semanage fcontext -a -t samba_share_t '/smbshare(/.*)?'
- restorecon -Rv /srv/www
- chcon -t httpd_sys_content_t /tmp/foo
- yum whatprovides sealer
- sealert -a /var/log/audit/audit.log

* DONE chmod, chown, setfacl, getfacl
  CLOSED: [2018-04-04 Wed 17:36]

- chmod 
- chown
- getfacl
- setfacl -m u:mary:rw /share

* DONE mariadb
  CLOSED: [2018-04-04 Wed 17:34]

- yum install mariadb-server mariadb
- systemctl status mariadb
- systemctl enable mariadb
- systemctl start mariadb
- systemctl status mariadb

- mysql_secure_installation
- skip-networking
- /etc/my.cnf

- firewall-cmd --permanent --add-service=mysql
- firewall-cmd --reload
- firewall-cmd --list-all

- ss -lntp  | grep 3306

- create user jack@'%' identified by 'redhat'
- grant all privileges on *.* to jack@'%'
- show grants for jack@'%'
- create database product
- create table tbl (name varchar(25), price integer);
- desc tbl
- insert into tbl (name,price) values ("wine",300);
- insert into tbl (name,price) values ("coffee",200);
- insert into tbl values ("water",100);
- update tbl set price=250 where name="coffee"
- delete from tbl where name="water"
- select * from tbl
- revoke all privileges on *.* from jack@'%'

* DONE mariadb join, count, sum, group by, how deep
  CLOSED: [2018-04-04 Wed 17:34]
* TODO [0/6] httpd

- yum install httpd httpd-manual mod_ssl mod_wsgi telnet lynx elinks curl -y
- systemctl status httpd
- systemctl enable httpd
- systemctl start httpd
- systemctl status httpd

- firewall-cmd --list-services
- firewall-cmd --permanent --add-service=http
- firewall-cmd --permanent --add-service=https
- firewall-cmd --reload
- firewall-cmd --list-services

- telnet server12 80
- telnet server12 443

- lynx /usr/share/httpd/manual
- /etc/httpd/conf.d/vh.conf

<Directory /var/www/html/owndir>
order deny,allow
deny from all
allow from desktop12.f.com
</Directory>
  
<VirtualHost *:80>
DocumentRoot /var/www/html
ServerName server12.f.com
</Virtualhost>

<VirtualHost *:443>
DocumentRoot /var/www/html
ServerName server12.f.com
SSLEngine on
SSLCertificateFile /etc/pki/tls/certs/localhost.crt
SSLCertificateKeyFile /etc/pki/tls/private/localhost.key
#SSLCertificateChainFile /etc/pki/tls/certs/server-chain.crt
</VirtualHost>

<Directory /srv/www>
Require all granted
</Directory>
  
<VirtualHost *:80>
DocumentRoot /srv/www
ServerName portal.f.com
</Virtualhost>

- httpd -t
- httpd -S
- httpd -D DUMP_VHOSTS
- systemctl status httpd
- systemctl restart httpd
- systemctl status httpd

- curl http://server12
- curl http://server12/owndir/
- curl -k https://server12

- cd /etc/pki/tls/certs
- curl -O
- chmod 600 *.crt

- cd /etc/pki/tls/private/
- curl -O
- chmod 600 *.key

- ls -lZ /var/www
- mkdir /srv/www
- semanage fcontext -a -t httpd_sys_content_t '/srv/www(/.*)?'
- restorecon -Rv /srv/www

* genkey? have to?
* TODO nfs

- systemctl status nfs-server
- systemctl enable nfs-server
- systemctl start nfs-server
- systemctl status nfs-server

- mkdir /nfsshare
- [ ] chown, chmod, chgrp, setfacl

- /etc/exports
- exportfs -rv

- firewall-cmd --permanent --add-service=nfs
- firewall-cmd --permanent --add-service=rpc-bind
- firewall-cmd --permanent --add-service=mountd

- mount -t nfs server12:/nfsshare /mnt/nfsshare

- server12:/nfsshare /mnt/nfsshare nfs defaults,_netdev 0 0

* TODO nfs but secure, nfs-secure-server only centos 7.0

- /etc/sysconfig/nfs
- "-V 4.2"
- [ ] systemctl status nfs-secure-server
- [ ] curl -O to download keytab file

- [ ] curl -O to download keytab file
- [ ] systemctl status nfs-server

- [ ] nfs-secure
- mount -t nfs -o sec=krb5p,vers=4.2 server12:/nfsshare /mnt/nfsshare

- server12:/nfsshare /mnt/nfsshare nfs defaults,sec=krb5p,_netdev 0 0

* TODO samba

- yum install samba samba-client -y
- systemctl status smb nmb
- systemctl enable smb nmb
- systemctl start smb nmb
- systemctl status smb nmb

- firewall-cmd --permanent --add-service=samba
- firewall-cmd --reload
- firewall-cmd --list-services

- groupadd sales
- useradd -s /sbin/nologin jack
- useradd -s /sbin/nologin raul
- useradd -s /sbin/nologin mary
- usermod -aG sales jack
- usermod -aG sales raul
- groupmems -g sales -l
- smbpasswd -a jack
- smbpasswd -a raul
- smbpasswd -a mary
- pdbedit -L

- mkdir /smbshare
- chgrp sales /smbshare
- chmod 2777 /smbshare
- semanage fcontext -a -t samba_share_t '/smbshare(/.*)?'
- restorecon -Rv /smbshare

- /etc/samba/smb.conf
  [smbshare]
  path = /smbshare
  valid users = @sales nerd 
  write list = @sales
  broweable = yes
- testparm
- systemctl restart smb nmb

- smbclient -L server12.f.com -U jack
- smbclient //server12.f.com/smbshare -U jack

- /etc/passwd.samba
  username=jack
  password=redhat
- chmod 700 /etc/passwd.samba
- yum install cifs-utils -y
- mount -t cifs -o credentials=/etc/passwd.samba
  //server12.f.com/smbshare /mnt/smbshare

- mount -t cifs -o credentials=/etc/passwd.samba,sec=ntlmssp,multiuser 
  //server12.f.com/smbshare /mnt/smbshare
- [ ] cifscreds add jack server12
- [ ] keyctl

* DONE [0/1] postfix but null client
  CLOSED: [2018-03-08 Thu 15:19]

- systemctl status postfix
- systemctl enable postfix
- systemctl start postfix
- postconf
- postconf -n
- postconf | grep ^my
- postconf -e "mydestination="
- postconf -e "myorigin=example.com"
- postconf -e "mynetworks=127.0.0.0/8, [::1]/128"
- postconf -e "inet_interfaces=loopback-only"
- postconf -e "relayhost=[server12.example.com]"
- systemcl restart postfix
- [ ] test by 

* DONE [0/1] iscsi.server.pre
  CLOSED: [2018-03-08 Thu 11:41]

- fdisk -l | grep Disk
- lsblk
- dmesg
- mount

- yum install gdisk -y
- +500M
- 8e00
- partprobe

- pvcreate /dev/sdb1
- vgcreate vg_storage /dev/sdb1
- vgdisplay vg_storage | grep PE
- lvcreate -n lv_media -l 40 vg_storage
- lvcreate -n lv_data -L 40M vg_storage
- lvdisplay
- lvs

- [ ] and MiB (1MiB -eq 1048576 but 1MB -eq 1000000)

* DONE iscsi.server
  CLOSED: [2018-03-08 Thu 13:38]

- yum install targetcli -y
- systemctl status target
- systemctl enable target
- systemctl start target
- systemctl status target

- firewall-cmd --permanent --add-port=3260/tcp
- firewall-cmd --reload
- firewall-cmd --list-ports

- target
- cd /backstores/block
- create i_image /dev/vg_storage/lv_media
- cd /iscsi
- create iqn.2018-03.com.f:server12
- cd iqn.2018-03.com.f:server12/tpg1
- ls
- cd acls
- create iqn.2018-03.com.f:desktop12
- cd ../luns
- create /backstores/block/i_image
- exit
- /etc/target/saveconfig.json
- systemctl restart target

* DONE iscsi.client
  CLOSED: [2018-03-08 Thu 13:38]

- yum install iscsi-initiator-utils -y
- /etc/iscsi/initiatorname.iscsi
- InitiatorName=iqn.2018-03.com.f:desktop12
- systemctl status iscsi
- systemctl start iscsi
- systemctl status iscsi
- man iscsiadm | grep discoverydb
- iscsiadm -m discoverydb -t st -p server12.f.com --discover
- man iscsiadm | grep node
- iscsiadm -m node -T iqn.2018-03.com.f:server12 -p server12.f.com -l
- dmesg
- fdisk -l | grep Disk
- yum install gdisk -y
- gdisk /dev/sdc
- partprobe
- mkfs.xfs /dev/sdc1
- blkid
- /etc/fstab
- UUID=ef1859f9-33dc-4df6-abe5-83baecb614f1 xfs defaults,_netdev 0 0
- iscsiadm -m session
- iscsiadm -m session -P 0
- iscsiadm -m session -P 1
- iscsiadm -m session -P 2
- iscsiadm -m session -P 3
* DONE bash, case, if
  CLOSED: [2018-04-04 Wed 17:35]

#+BEGIN_SRC sh
  case $1 in
      ping)
          echo pong
          ;;
      pong)
          echo ping
          ;;
      ,*)
          echo nil
          ;;
  esac

  for user in `cat list`;
  do
      echo $user
  done

  if [ -e /etc/passwd ];
  then
      echo exist
  fi
#+END_SRC

* TODO dns caching, ntp, to do or not have to do?

